<!DOCTYPE HTML>
<!--
	Identity by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Tracker</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>

		<script src="https://www.gstatic.com/firebasejs/5.8.5/firebase.js"></script>

			<script>
			    // Initialize Firebase
			    var config = {
			      apiKey: "AIzaSyDabYfBxOCRUizOOn1eiyimxmdv0Bmr13Q",
			      authDomain: "candidatetracker-58223.firebaseapp.com",
			      databaseURL: "https://candidatetracker-58223.firebaseio.com",
			      projectId: "candidatetracker-58223",
			      storageBucket: "candidatetracker-58223.appspot.com",
			      messagingSenderId: "423650086109"
			    };
			    firebase.initializeApp(config);
			 </script>

			<script src="/__/firebase/5.7.0/firebase-app.js"></script>
		  <script src="/__/firebase/5.7.0/firebase-auth.js"></script>
		  <script src="https://www.gstatic.com/firebasejs/3.1.0/firebase-auth.js"></script>
		  <script src="https://www.gstatic.com/firebasejs/3.1.0/firebase-database.js"></script>
		  <script src="/__/firebase/init.js"></script>

		  <script type="text/javascript">
		    /**
		     * Function called when clicking the Login/Logout button.
		     */
		    // [START buttoncallback]
		    function toggleSignIn() {
		      if (!firebase.auth().currentUser) {
		        // [START createprovider]
		        var provider = new firebase.auth.GoogleAuthProvider();
		        // [END createprovider]
		        // [START addscopes]
		        provider.addScope('https://www.googleapis.com/auth/plus.login');
		        // [END addscopes]
		        // [START signin]
		        firebase.auth().signInWithRedirect(provider);
		        // [END signin]
		      } else {
		        // [START signout]
		        firebase.auth().signOut();
		        // [END signout]
		      }
		      // [START_EXCLUDE]
		      document.getElementById('quickstart-sign-in').disabled = true;
		      // [END_EXCLUDE]
		    }
		    // [END buttoncallback]
		    /**
		     * initApp handles setting up UI event listeners and registering Firebase auth listeners:
		     *  - firebase.auth().onAuthStateChanged: This listener is called when the user is signed in or
		     *    out, and that is where we update the UI.
		     *  - firebase.auth().getRedirectResult(): This promise completes when the user gets back from
		     *    the auth redirect flow. It is where you can get the OAuth access token from the IDP.
		     */
		    function initApp() {
		      // Result from Redirect auth flow.
		      // [START getidptoken]
		      firebase.auth().getRedirectResult().then(function(result) {
		        if (result.credential) {
		          // This gives you a Google Access Token. You can use it to access the Google API.
		          var token = result.credential.accessToken;
		          // [START_EXCLUDE]
		          //document.getElementById('quickstart-oauthtoken').textContent = token;
		        } else {
		          //document.getElementById('quickstart-oauthtoken').textContent = 'null';
		          // [END_EXCLUDE]
		        }
		        // The signed-in user info.
		        var user = result.user;

		      }).catch(function(error) {
		        // Handle Errors here.
		        var errorCode = error.code;
		        var errorMessage = error.message;
		        // The email of the user's account used.
		        var email = error.email;
		        // The firebase.auth.AuthCredential type that was used.
		        var credential = error.credential;
		        // [START_EXCLUDE]
		        if (errorCode === 'auth/account-exists-with-different-credential') {
		          alert('You have already signed up with a different auth provider for that email.');
		          // If you are using multiple auth providers on your app you should handle linking
		          // the user's accounts here.
		        } else {
		          console.error(error);
		        }
		        // [END_EXCLUDE]
		      });
		      // [END getidptoken]
		      // Listening for auth state changes.
		      // [START authstatelistener]
		      firebase.auth().onAuthStateChanged(function(user) {
		        if (user) {
		          // User is signed in.
		          var displayName = user.displayName;

		          document.getElementById("name").textContent = displayName;

		          var email = user.email;
		          var emailVerified = user.emailVerified;
		          var photoURL = user.photoURL;
		          var isAnonymous = user.isAnonymous;
		          var uid = user.uid;
		          var providerData = user.providerData;
		          // [START_EXCLUDE]
		          // document.getElementById('quickstart-sign-in-status').textContent = 'Signed in';
		          document.getElementById('quickstart-sign-in').textContent = 'Sign out';
		          //document.getElementById('quickstart-account-details').textContent = JSON.stringify(user, null, '  ');
		          var db = firebase.database();
		          var reqCount = firebase.database().ref('users/' + uid + '/requirements');
		          // reqCount.on('value', function(snapshot) {
		          //   document.getElementById('special_number').textContent = snapshot.val();
		          // });
		          // [END_EXCLUDE]
		          queryDatabase();
		        } else {
		          // User is signed out.
		          // [START_EXCLUDE]
		          // document.getElementById('quickstart-sign-in-status').textContent = 'Signed out';
		          document.getElementById('quickstart-sign-in').textContent = 'Sign in with Google';
				  document.getElementById("name").textContent = "Jane Doe";
				  document.getElementById("Challenge").textContent = "";
				  document.getElementById("Officer Chat").textContent = "";
				  document.getElementById("Prof").textContent = "";
				  document.getElementById("Social").textContent = "";
		          // document.getElementById('quickstart-account-details').textContent = 'null';
		          // document.getElementById('quickstart-oauthtoken').textContent = 'null';
		          // [END_EXCLUDE]
		        }
		        // [START_EXCLUDE]
		        document.getElementById('quickstart-sign-in').disabled = false;
		        // [END_EXCLUDE]
		      });
		      // [END authstatelistener]
		      document.getElementById('quickstart-sign-in').addEventListener('click', toggleSignIn, false);

		    }
		    function writeUserEmailData() {
		      console.log("writing user datagmfdlkg...")
		      var user = firebase.auth().currentUser;
		      if (user) {
		        firebase.database().ref('users/' + user.uid).set({
		          requirements: 543543543,
		          email: user.email
		        });
		      }
		    }

		    window.onload = function() {
		      initApp();
		    };
		    function queryDatabase() {
            var database = firebase.database();
            var uid = firebase.auth().currentUser.uid;
            var reqCount = firebase.database().ref('users/' + uid + '/requirements');
            reqCount.once('value').then(function(snapshot) {
              var lst = [];
              var dict = new Map();
              snapshot.forEach(function(childSnapshot) {
                   dict.set(childSnapshot.key, childSnapshot.val())
              });
              var currVal = "";
              for (var [key, value] of dict) {
                currVal = key + ": " + value;
                document.getElementById(key).textContent = currVal;
              }
            });
        }
		  </script>


	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<section id="main">
						<header>
							<span class="avatar"><img src="images/upelogo.png" alt="" /></span>
							<h1 id="name">Jane Doe</h1>
							<p id="Challenge"></p>
			                <p id="Officer Chat"></p>
			                <p id="Prof"></p>
			                <p id="Social"></p>
						</header>
						<!--
						<hr />
						<h2>Extra Stuff!</h2>
						<form method="post" action="#">
							<div class="fields">
								<div class="field">
									<input type="text" name="name" id="name" placeholder="Name" />
								</div>
								<div class="field">
									<input type="email" name="email" id="email" placeholder="Email" />
								</div>
								<div class="field">
									<select name="department" id="department">
										<option value="">Department</option>
										<option value="sales">Sales</option>
										<option value="tech">Tech Support</option>
										<option value="null">/dev/null</option>
									</select>
								</div>
								<div class="field">
									<textarea name="message" id="message" placeholder="Message" rows="4"></textarea>
								</div>
								<div class="field">
									<input type="checkbox" id="human" name="human" /><label for="human">I'm a human</label>
								</div>
								<div class="field">
									<label>But are you a robot?</label>
									<input type="radio" id="robot_yes" name="robot" /><label for="robot_yes">Yes</label>
									<input type="radio" id="robot_no" name="robot" /><label for="robot_no">No</label>
								</div>
							</div>
							<ul class="actions special">
								<li><a href="#" class="button">Get Started</a></li>
							</ul>
						</form>
						<hr />
						-->
						<footer>
							<ul class="icons">
								<li id="quickstart-sign-in"><a href="#" class="signin">Sign In</a></li>
							</ul>
						</footer>
					</section>

				<!-- Footer -->
					<footer id="footer">
						<ul class="copyright">
							<li>&copy; Jane Doe</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</footer>

			</div>

		<!-- Scripts -->
			<script>
				if ('addEventListener' in window) {
					window.addEventListener('load', function() { document.body.className = document.body.className.replace(/\bis-preload\b/, ''); });
					document.body.className += (navigator.userAgent.match(/(MSIE|rv:11\.0)/) ? ' is-ie' : '');
				}
			</script>

	</body>
</html>
